{% if config.extra.alternate and page and page.canonical_url %}
  {% set page_url = page.canonical_url | replace(config.site_url, '') %}
  
  {# Удаляем языковой префикс для получения базового пути #}
  {% set ns = namespace(clean_path=page_url) %}
  {% for alt in config.extra.alternate %}
    {% if alt.lang != 'en' %}
      {% set lang_prefix = alt.lang ~ '/' %}
      {% if page_url.startswith(lang_prefix) %}
        {% set ns.clean_path = page_url[lang_prefix|length:] %}
      {% endif %}
    {% endif %}
  {% endfor %}
  
  {# Генерируем теги alternate для каждого языка #}
  {% for alt in config.extra.alternate %}
    {% if alt.lang == 'en' %}
<link rel="alternate" href="{{ config.site_url }}{{ ns.clean_path }}" hreflang="{{ alt.lang }}">
    {% else %}
<link rel="alternate" href="{{ config.site_url }}{{ alt.lang }}/{{ ns.clean_path }}" hreflang="{{ alt.lang }}">
    {% endif %}
  {% endfor %}
  {# x-default указывает на английскую версию #}
<link rel="alternate" href="{{ config.site_url }}{{ ns.clean_path }}" hreflang="x-default">
{% endif %}

